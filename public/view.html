<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>psdtowebEditInterfacessssNoneRast329.psd</title>
		<link href="styles.css" rel="stylesheet" type="text/css">
	</head>
	<body>

		<div id="background">
			<div id="Time" class="time">
				<span id="minutesSlot">00</span>
				<span id="timeSeparator">:</span>
				<span id="secondsSlot">00</span>
			
			
			</div>

			<div>
			<div class="period">
				<div id="LabelPeriod"><img src="images/LabelPeriod.png"></div>
				<div id="Period"><h2 class="smallerText">0</h2></div>
				
				
			</div>
			<div class="fouls">
			<div id="LabelFouls"><img src="images/LabelFouls.png"></div>
			
			
			
			
			<div id="LabelFoulsHome"><img src="images/LabelFouls.png"></div>
			

			<div id="FoulsGuest"><h2 class="smallerText">0</h2></div>

			<div id="FoulsHome"><h2 class="smallerText">000</h2></div>
			
			</div>
			<div class="timeouts">
			<div id="HomeLabelTimeouts"><img src="images/HomeLabelTimeouts.png"></div>
			<div id="HomeTimeouts"><h2 class="smallerText">0</h2></div>
	

			<div id="GuestLabelTimeouts"><img src="images/GuestLabelTimeouts.png"></div>
			<div id="GuestTimeouts"><h2 class="smallerText">0</h2></div>
			
			</div>
			<div class="score">
			<div id="LabelHome"><img src="images/LabelHome.png"></div>
			<div id="HomeScore"><h2 class="Scores">0</h2></div>
			
			
			<div id="LabelGuest"><img src="images/LabelGuest.png"></div>
			<div id="ScoreGuest"><h2 class="Scores">0</h2></div>
			
</div>			



			
			
		</div>
		
	


	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script>
	var isPaused;
	var isTextArea;
	var isUnderMin;
	var time;


	    $(document).ready(function() {
		        var socket = io();


		        //PING
		        
/*
				socket.on('disconnect', function(){
				        console.log('user disconnected');
				});
		        setInterval(function() {
  					startTime = Date.now();
  					socket.emit('ping');
				}, 2000);

				socket.on('pong', function() {
				  latency = Date.now() - startTime;
				  console.log(latency);
				});
*/
				//HOME SCORE		       
	     
		        socket.on('HomeScoreChange', function(new_score){		         
		          $('#HomeScore').children('h2').html(new_score);
		        
		        });

		        //GUEST SCORE
	     
		       socket.on('GuestScoreChange', function(new_score){		      		   
		          $('#ScoreGuest').children('h2').html(new_score);

		       });
		       // FOULS HOME
	     
		       socket.on('HomeFoulChange', function(new_score){		      		   
		          $('#FoulsHome').children('h2').html(new_score);
		       });
	     
		       socket.on('GuestFoulChange', function(new_score){		      		   
		          $('#FoulsGuest').children('h2').html(new_score);
		       });
		       // TIMEOUTS HOME

	     
		       socket.on('HomeTimeoutChange', function(new_score){		      		   
		          $('#HomeTimeouts').children('h2').html(new_score);
		       });

	     
		       socket.on('GuestTimeoutChange', function(new_score){		      		   
		          $('#GuestTimeouts').children('h2').html(new_score);
		       });

		       // PEROIOD

		       socket.on('PeriodChange', function(new_score){		      		   
		          $('#Period').children('h2').html(new_score);
		       });	



		       socket.on("TimePlay", function(newtime){
		       	time = newtime;
		       		Play();
		       });
		       
		       
		       socket.on('TimePause', function(newtime){
		       	time = newtime;
				Pause();
		       });
		       	
		    	socket.on('TimeChange', function(newtime){
		    		time = newtime;
		    		
		    	});

		    	socket.on('SeparatorChange', function(newIsUnderMin){
		    		isUnderMin = newIsUnderMin;
		    	});

		    	
				socket.on('toggleField', function(data){
					toggle(data.elementClass, data.isVisible);

				});
		    	
		       socket.on("start", function(){
		       		if (parseInt($('#Period').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#Period').addClass("ConvertedToDoubleDigits");
		       			$('#Period').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#Period').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#Period').addClass("ConvertedToSingleDigits");
		       			$('#Period').removeClass('ConvertedToDoubleDigits');
		       		}	

		       		if (parseInt($('#GuestTimeouts').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#GuestTimeouts').addClass("ConvertedToDoubleDigits");
		       			$('#GuestTimeouts').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#GuestTimeouts').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#GuestTimeouts').addClass("ConvertedToSingleDigits");
		       			$('#GuestTimeouts').removeClass('ConvertedToDoubleDigits');
		       		}

		       		if (parseInt($('#HomeTimeouts').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#HomeTimeouts').addClass("ConvertedToDoubleDigits");
		       			$('#HomeTimeouts').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#HomeTimeouts').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#HomeTimeouts').addClass("ConvertedToSingleDigits");
		       			$('#HomeTimeouts').removeClass('ConvertedToDoubleDigits');
		       		}

		       		if (parseInt($('#FoulsGuest').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#FoulsGuest').addClass("ConvertedToDoubleDigits");
		       			$('#FoulsGuest').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#FoulsGuest').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#FoulsGuest').addClass("ConvertedToSingleDigits");
		       			$('#FoulsGuest').removeClass('ConvertedToDoubleDigits');
		       		}

		       		if (parseInt($('#FoulsHome').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#FoulsHome').addClass("ConvertedToDoubleDigits");
		       			$('#FoulsHome').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#FoulsHome').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#FoulsHome').addClass("ConvertedToSingleDigits");
		       			$('#FoulsHome').removeClass('ConvertedToDoubleDigits');
		       		}

		       		if (parseInt($('#HomeScore').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#HomeScore').addClass("ConvertedToDoubleDigits");
		       			$('#HomeScore').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#HomeScore').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#HomeScore').addClass("ConvertedToSingleDigits");
		       			$('#HomeScore').removeClass('ConvertedToDoubleDigits');
		       		}

		       		if (parseInt($('#ScoreGuest').children('h2').text()) >= 10) {
		       			//convertToDoubleDigits('#Period');
		       			$('#ScoreGuest').addClass("ConvertedToDoubleDigits");
		       			$('#ScoreGuest').removeClass('ConvertedToSingleDigits');
		       		}	
		       		if (parseInt($('#ScoreGuest').children('h2').text()) <= 9) {
		       			//	convertToSingleDigits('#Period');
		       			$('#ScoreGuest').addClass("ConvertedToSingleDigits");
		       			$('#ScoreGuest').removeClass('ConvertedToDoubleDigits');
		       		}		       		

		       });

		       





		       function convertToDoubleDigits(name) {
		       	if ($(name).hasClass('ConvertedToDoubleDigits')) {
		       		return;
		       	}
		       	console.log('converting to double digits');
		       	$(name).addClass("ConvertedToDoubleDigits");
		       	$(name).removeClass('ConvertedToSingleDigits');
		       	var amount = 9;
		       	if(name == "#HomeScore" || name == '#ScoreGuest'){
		       		amount= 16;
		       	}

		       	$(name).css('left', parseInt($(name).css('left')) - amount );

		       }

		       function convertToSingleDigits(name) {
		       	if ($(name).hasClass('ConvertedToSingleDigits')) {
					return;
		       	}
		       	console.log('Converiting ti single digits');
		       	$(name).addClass("ConvertedToSingleDigits");
		       	$(name).removeClass('ConvertedToDoubleDigits');
		       	var amount = 9;
		       	if(name == "#HomeScore" || name == '#ScoreGuest'){
		       		amount= 16;
		       	}
		       	console.log(amount);
		      	 $(name).css('left',parseInt($(name).css('left') ) + amount);
		       }

		       setInterval(function(){
		       		if (parseInt($('#Period').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#Period');
		       		}	
		       		if (parseInt($('#Period').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#Period');
		       		}	
		       		
		       		if (parseInt($('#GuestTimeouts').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#GuestTimeouts');
		       		}	
		       		if (parseInt($('#GuestTimeouts').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#GuestTimeouts');
		       		}	

		       		if (parseInt($('#HomeTimeouts').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#HomeTimeouts');
		       		}	
		       		if (parseInt($('#HomeTimeouts').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#HomeTimeouts');
		       		}	


		       		if (parseInt($('#FoulsGuest').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#FoulsGuest');
		       		}	
		       		if (parseInt($('#FoulsGuest').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#FoulsGuest');
		       		}

		       		if (parseInt($('#FoulsHome').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#FoulsHome');
		       		}	
		       		if (parseInt($('#FoulsHome').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#FoulsHome');
		       		}


		       		if (parseInt($('#ScoreGuest').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#ScoreGuest');
		       		}	
		       		if (parseInt($('#HomeScore').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#HomeScore');
		       		}

		       		if (parseInt($('#HomeScore').children('h2').text()) >= 10) {
		       			convertToDoubleDigits('#HomeScore');
		       		}	
		       		if (parseInt($('#ScoreGuest').children('h2').text()) <= 9) {
		       			convertToSingleDigits('#ScoreGuest');
		       		}


		       }, 100);





	});
				
				//



		       function parseScore(socoreText, operation) {
		          var old_score_int = parseInt(socoreText);
		          if (operation == "+"){var new_score = old_score_int + 1};
		          if (operation == "-"){var new_score = old_score_int - 1};
		          if(new_score < 0){new_score = 0};
		          
		          return new_score;
		        }

		        document.addEventListener('gesturestart', function (e) {
    				e.preventDefault();
				});





				function Reset(){
					socket.emit('reset');

				}

				//Hide Code


				function toggle(elementClass, isVisible){
					console.log(elementClass);
					console.log(isVisible);
					if(isVisible){
						$('.' + elementClass).fadeIn();
						$('*[data-a="'+ elementClass+'"]').addClass('checked');
						
						
						
					}
					else if(!isVisible){
						$('.' + elementClass).fadeOut();
						$('*[data-a="'+ elementClass+'"]').removeClass('checked');
					}

				}



	
function Pause(){
	$('#Pause').fadeOut("100");
	$('#Play').fadeIn("100");
	isPaused=true;
	
}
function Play(){
	$('#Play').fadeOut("100");
	$('#Pause').fadeIn("100");
	isPaused=false;
	
}	


function ToTextArea(id){
	if(isTextArea)
		return;
	$('#Play').hide();
	$('#Pause').hide();
	$('#save').show();
	$('#Time').css("left", "138px");
	$('#Time').css("top", "-1px");
	
	
	isTextArea = true;
	var textm = $('#minutesSlot').text();
	var texts = $('#secondsSlot').text();
	$('#secondsSlot').html('<textarea class="textsecondsSlot">' + texts+'</textarea>');
	$('#minutesSlot').html('<textarea class="textminutesSlot">'+textm+' </textarea>');
	$('#timeSeparator').addClass("btn");
}

//GET THE TIME
		setInterval(function(){
		if(isPaused){
			return
		}
		if(Math.floor(time - 100) <= 0){time = 0}else{
			time = time - 100;
		}
		
		
	}, 100);

//UPDATE THE BOARD
//TODO change the times postion if double digits
	setInterval(function(){

		if(isTextArea){
			return
		}

		var timeObject =  convertMillisecondsToDigitalClock(time);
		if (timeObject.minutes >= 10 && timeObject.seconds >= 10) {
			console.log("aYe");
			$('#Time').addClass('doubleDigitsTime');
		}else{
			$('#Time').removeClass('doubleDigitsTime');
		}
		if (timeObject.minutes >= 10 && timeObject.seconds < 10) {
			
			$('#Time').addClass('doubleDigitsTimeSeconds');
		}else{
			$('#Time').removeClass('doubleDigitsTimeSeconds');
		}
		
		if (timeObject.minutes == 0) {
			isUnderMin = true;
			$('#minutesSlot').text(timeObject.seconds);
			$('#secondsSlot').text(timeObject.tenthseconds);
			$('#Time').css('left', '237');
			$('#timeSeparator').text('.');
			
			return;
		}
		isUnderMin = false;
		$('#timeSeparator').text(':');
		$('#minutesSlot').text(timeObject.minutes);
		$('#secondsSlot').text(timeObject.seconds);

	}, 100);



	// CONVERT MILLISECONDS TO DIGITAL CLOCK FORMAT
	function convertMillisecondsToDigitalClock(ms) {
	    var hours = Math.floor(ms / 3600000); // 1 Hour = 36000 Milliseconds
	    var minutes = Math.floor(ms  / 60000); // 1 Minutes = 60000 Milliseconds
	    var seconds = Math.floor(((ms % 360000) % 60000) / 1000) ;	// 1 Second = 1000 Milliseconds
	    var tenthseconds = Math.floor((((ms % 360000) % 60000) % 1000) / 100);
	    var miliseconds = (((ms % 360000) % 60000) % 1000);
	        return {
		        hours : hours,
		        minutes : minutes,
		        seconds : seconds,
		        miliseconds:miliseconds,
		        tenthseconds: tenthseconds,
		        clock : hours + ":" + minutes + ":" + seconds + "." + tenthseconds
	    	};
	}



    </script>
 </body>
 </html>